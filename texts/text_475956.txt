

Как мы создавали технологию оптического распознавания текста. OCR в Яндексе / Habr


               18  November  2019 at 10:24  Как мы создавали технологию оптического распознавания текста. OCR в Яндексе Яндекс corporate blog Image processing *Machine learning *Artificial Intelligence  
        Recovery mode
           Привет! Сегодня я расскажу читателям Хабра о том, как мы создавали технологию распознавания текста, работающую на 45 языках и доступную пользователям Яндекс.Облака, какие задачи мы ставили и как их решали. Будет полезно, если вы работаете над схожими проектами или хотите узнать, как так получилось, что сегодня вам достаточно сфотографировать вывеску турецкого магазина, чтобы Алиса перевела её на русский.




Технология Optical character recognition (OCR) развивается в мире уже десятки лет. Мы в Яндексе начали разрабатывать собственную технологию OCR, чтобы улучшить свои сервисы и дать пользователям больше возможностей. Картинки — это огромная часть интернета, и без способности их понимать поиск по интернету будет неполным.


Решения для анализа изображений становятся все более востребованными. Это связано с распространением искусственных нейронных сетей и устройств с качественными сенсорами. Понятно, что в первую очередь речь идет о смартфонах, но не только о них. 


Сложность задач в области распознавания текста постоянно растет — все начиналось с распознавания отсканированных документов. Потом добавилось  распознавание Born-Digital-картинок с текстом из интернета. Затем, с ростом популярности мобильных камер, — распознавание хороших снимков с камеры (Focused scene text). И чем дальше, тем больше параметры усложнялись: текст может быть нечетким (Incidental scene text), написанным с любым изгибом или по спирали, самых разных категорий — от фотографий чеков до прилавков магазинов и вывесок.

Какой путь мы прошли

Распознавание текста — это отдельный класс задач компьютерного зрения. Как и многие алгоритмы компьютерного зрения, до популярности нейросетей оно во многом основывалось на ручных признаках и эвристиках. Однако за последнее время, с переходом на нейросетевые подходы, качество технологии существенно выросло. Посмотрите на пример на фото. Как это происходило, я расскажу дальше.


Сравните сегодняшние результаты распознавания с результатами в начале 2018 года: 






2018

Увлажняющая

n HO -мичеллярная

роскошная гладкость вода.

бережная мультифункциональная 

формула

использования В качестве средства

Sl ДЛЯ

вместо очищающего лосьона или 

тоника

Без спирта, красителей, парабенов

…
2019

УВЛАЖНЯЮЩАЯ

ТЕРМАЛЬНО-МИЦЕЛЛЯРНАЯ ВОДА

«РОСКОШНАЯ ГЛАДКОСТЬ»

AUBY Мягкая и бережная 

мультифункциональная формула

для ежедневного использования в 

качестве средства для

демакияжа, вместо очищающего 

лосьона или тоника.

Без спирта, красителей, парабенов

…

Какие трудности нам встретились сначала

В начале своего пути мы делали технологию распознавания для русского и английского языков, а основными сценариями использования были сфотографированные страницы текста и картинки из интернета. Но в ходе работы мы поняли, что этого недостаточно: текст на изображениях встречался на любом языке, на любой поверхности, а картинки порой оказывались самого разного качества. Значит, распознавание должно работать в любой ситуации и на всех типах входящих данных.


И тут мы столкнулись с рядом сложностей. Вот только некоторые:


Детали. Для человека, привыкшего получать из текста информацию, текст на изображении — это абзацы, строки, слова и буквы, но для нейронной сети все выглядит по-другому. Из-за сложной природы текста сеть вынуждена видеть как картину в целом (например, если люди взялись за руки и выстроили собой надпись), так и мельчайшие детали (во вьетнамском языке похожие символы 