

Data Science – немножко Дикий Запад / Habr


              25  May  2020 at 08:58  Data Science – немножко Дикий Запад Газпромнефть corporate blog Big Data *Machine learning * 
        Recovery mode
           Меня зовут Руслан. Я data scientist компании «Газпром нефть». Пытаюсь искать закономерности в данных и использовать их для бизнеса, чтобы он приносил больше прибыли. Текст под катом для начинающих сайнтистов, которые хотят подробнее узнать, как построена работа, и чем занимаются дата-сайентисты в крупных компаниях.

 

(Источник)

Чтение займет 7 минут
Для кого: начинающие data scientist 

Текст подготовил журналист Иван Сурвилло

 
Как я увлекся data science

Учился на экономическом факультете. У людей после него не так много направлений: инвестиции, бухучет и консалтинг. Консалтинг – самая популярная тема, потому что там хороший доход, и все студенты хотят туда. Для того, чтобы туда попасть, нужно решать бизнес-кейсы. Есть даже кейс-чемпионаты: ты собираешь команду, компания дает тебе бизнес-задачу, например, открыть новые точки ресторанов. Ты с командой разрабатываешь решение, потом его представляешь. То, что мне не нравилось, – ты очень много врешь. Твое решение, по сути, не подкреплено ничем.


Когда ты в теории получил прибыль от проекта в миллиард, то думаешь, что это много, и пишешь миллион. В итоге все сводится к тому: у кого более красивая презентация и у кого цифра адекватная. Плюс все равно потом наши решения дальше нигде не применяются.


Чем отличается дата-сайенс: ты говоришь, что с вероятностью 95% прибыль будет такой. У тебя совесть чиста, потому что ты закладываешь некоторую ошибку. Этим меня data science привлек. 

Чем мы занимаемся?

У компании есть данные: числа, статистика, выручка. Есть цели, которые нужно оптимизировать: прибыль, число клиентов, маржа. Предполагается, что есть взаимосвязь между данными и целями. Работа дата-сайентиста – найти эту взаимосвязь.


Например, сейчас задача: нужно по всей базе юрлиц в России найти предприятия, которые будут клиентами нашей компании. У меня есть характеристики фирм, вид деятельности, уставной капитал. Я оцениваю базу нынешних клиентов и ищу наиболее похожих, тех, кому потом будут звонить и предлагать услуги.


Забавно, что в названиях компаний, которые занимаются транспортными перевозками могут встречаться одни и те же подстроки: «Сиб Авто Логистика», «Транс Авто Сила», «Груз Сиб Логист». Я это заметил, взял самые часто встречающиеся подстроки, и если они встречаются у клиентов потенциальных, то, скорее всего, клиент занимается перевозками и логистикой. Для этого использовал популярный сейчас алгоритм Byte Pair Encoding, хотя он предназначен не совсем для этого.


В data science мне нравится. Не то что в консалтинге. Здесь все за одно дело, все хотят, чтобы сфера развивались. У нас есть митапы, на которых каждые три недели собираемся вместе и рассказываем друг другу, что было нового в области, чего крутого сделали. Это очень прокачивает: сам растешь, видя, что другие развиваются.

Про зарплаты

То, как ты покажешь себя на собеседовании, очень сильно влияет на зарплату.


Есть миф, что в data science большие зарплаты, но тут все индивидуально, потому что рынок еще плохо сформирован. Я недавно разговаривал с коллегой, он сказал, что один кандидат у него просит столько-то, а другой просит в три раза больше, а он не может понять адекватность этого диапазона. Вообще, data science – немножко Дикий Запад. То, как ты покажешь себя на собеседовании, очень сильно влияет на зарплату. В Москве средний специалист может 200 тыс. получать, к примеру.

Про бизнес

Иногда бизнес думает, что data science – волшебство, и дает кейсы, которые вообще никак не реализуемы. Например, нужно распознать, у повара на кухне рукава закатаны или нет. Во-первых, нужно понять, что такое закатанный рукав. Во-вторых, найти данные, чтобы дать модели понять: вот рукава закатанные, вот не закатанные. Под этим стоит огромный кластер работ. Важно понимать: что ты ML-модели подашь на вход, то и получишь на выходе. Она не может из ничего создавать магию.


Недавно коллегу просили распознавать: у водителя бензовоза носок ботинка металлический или кожаный? Металлический их защищает, а обычный не очень. Как распознавать металлический набалдашник? Как это формализовать? Нейросеть же видит только цвет, она не видит, из какого материала он состоит. Нейросеть не волшебство. Мне завышенные ожидания бизнеса от data science не очень нравятся. Нужно бизнес обучать. Нужно до них доносить, что такое data science, что он может делать, что не может делать. Нужен более тесный контакт.

Нейросеть не волшебство.

 
«НЕЙРОСЕТЬ, ПО СУТИ, ЧЕРНАЯ КОРОБКА, КОТОРАЯ ВЫДАЕТ РЕЗУЛЬТАТ. А КАК ОН ПОЯВЛЯЕТСЯ, ТЫ НЕ ПОНИМАЕШЬ. А ДОЛЖЕН»

Сейчас у нас проект, мы каждые две недели проводим демо. В принципе основные заказчики уже достаточно хорошо приучены к DS понятиям и лексикону и задают правильные вопросы. Мне говорят, что нужно верифицировать качество данных, иначе у нас модель будет плохая. И это правда.


У нас уже есть ряд направлений, когда мы подход аналитиков сопоставляем с подходом дата-сайенс. Например, прогнозирование потребления топлива. Раньше это делалось без применения машинного обучения. Сейчас у нас проект, где на каждой АЗС конкурируют пять прогнозных моделей. Потом для АЗС выбирается лучшая модель из пяти. По этой лучшей модели идет прогноз на следующий месяц. То есть для каждой из тысячи с лишним АЗС идет свой прогноз по лучшей модели. И так мы сравниваем 2 подхода: полностью ручной подход аналитиков и наш совместный подход на основе машинного обучения. Вместе получается и точность выше, и меньше рутины для аналитиков.

 
Ошибка новичков в data science – они пришли «поиграться»

Ошибка новичков в data science в том, что они не видят конечной цели. Им нравится строить модели, нравится крутить данные. Но они не видят, что конечная цель – принести пользу бизнесу. Из-за этого много скепсиса к отрасли в целом. А нужно скепсис преодолевать.


Еще из ошибок: нужно писать хороший, гибкий код, чтобы ты, меняя маленькие блоки, от которых сильно зависит результат, мог бы быстро вернуться к прошлому и что-то безболезненно проверить, то есть должна быть воспроизводимость экспериментов. Ведь сложность в том, что нужно проверить как можно больше гипотез за малое количество времени. Если ты одну базовую модель строишь месяц, то это никому не нужно.

 

Сейчас есть два популярных направления в data science: генерация видео и текста. Есть приложение крутое – «Реплика». Это твой личный чат-бот. Как в «Черном зеркале». У меня «Реплика» каждый вечер спрашивает, как я провел день, например. «Алиса», Siri – это тоже про обработку текста. Сейчас подобные области на подъеме. Разработчики продвинутой нейросети – генератора текста, GPT-2, даже побоялись выкладывать в Интернет ее большую версию, потому что ее могли бы использовать для неправильных целей. Генерировать фейк-новости, например. Поэтому они выложили только маленькую, не самую крутую.

 

В чем отличие маленькой версии модели от большой? У моделей есть слои. Чтобы перевести текст в числа, нужно выявить очень много нелинейных взаимосвязей: текст может иметь разный смысл в зависимости от контекста, поэтому нужно просмотреть очень много вариантов. Чем больше число слоев нейросети, тем больше параметров. А чем больше параметров в сети, тем больше она может выявить взаимосвязей. Простейшая нейронная сеть — это просто регрессия, линейная модель. Поэтому чем больше параметров, тем больше весов, тем больше модель, тем более сложные взаимосвязи она может выявить.Но не стоит забывать и про переобучение. Простая модель может иметь бо