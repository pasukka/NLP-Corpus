

–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –º—É–ª—å—Ç–∏—è–∑—ã—á–Ω—ã–π —á–∞—Ç –¥–ª—è —Å–∞–π—Ç–∞ –Ω–∞ Tawk + Notion + Telegram + chatGPT + GPT-Index / Habr


               –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –º—É–ª—å—Ç–∏—è–∑—ã—á–Ω—ã–π —á–∞—Ç –¥–ª—è —Å–∞–π—Ç–∞ –Ω–∞ Tawk + Notion + Telegram + chatGPT + GPT-Index  Reading time  
    5 min
   Views  11K Website development *Python *JavaScript *Artificial Intelligence Flask *      –í –Ω–∞—à–µ–º —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–º –º–∏—Ä–µ —Å–æ–∑–¥–∞–Ω–∏–µ –æ–Ω–ª–∞–π–Ω-–ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –¥–ª—è –æ–±—â–µ–Ω–∏—è –º–µ–∂–¥—É –∫–ª–∏–µ–Ω—Ç–∞–º–∏ –∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª—è–º–∏ –∫–æ–º–ø–∞–Ω–∏–∏ - —ç—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ –¥–ª—è –º–Ω–æ–≥–∏—Ö –±–∏–∑–Ω–µ—Å–æ–≤. –û–Ω–ª–∞–π–Ω-—á–∞—Ç –¥–ª—è —Å–∞–π—Ç–∞ —è–≤–ª—è–µ—Ç—Å—è –æ–¥–Ω–∏–º –∏–∑ –Ω–∞–∏–±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö –∏ —É–¥–æ–±–Ω—ã—Ö —Å–ø–æ—Å–æ–±–æ–≤ —Å–≤—è–∑–∏ —Å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–º–∏ –∫–ª–∏–µ–Ω—Ç–∞–º–∏ –∏ —É–¥–µ—Ä–∂–∞–Ω–∏—è —É–∂–µ –∏–º–µ—é—â–∏—Ö—Å—è –∏–∑-–∑–∞ —Å–≤–æ–µ–π –±—ã—Å—Ç—Ä–æ–π –∏ –ø—Ä–æ—Å—Ç–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π.–Ø —Å–ª–µ–¥–∏–ª –∑–∞ —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –≤–∏–¥–∞–º–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è chatGPT —Å –º–æ–º–µ–Ω—Ç–∞ –µ–≥–æ –≤—ã—Ö–æ–¥–∞. –û–ø–∏—Å—ã–≤–∞–µ–º–æ–µ –¥–∞–ª–µ–µ —Ä–µ—à–µ–Ω–∏–µ —è –µ—â–µ –Ω–µ –≤—Å—Ç—Ä–µ—á–∞–ª –∏ –ø–æ—ç—Ç–æ–º—É –¥—É–º–∞—é –æ–Ω–æ –±—É–¥–µ—Ç –∫–æ–º—É-—Ç–æ –ø–æ–ª–µ–∑–Ω—ã–º.–§–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∞ –∑–∞–¥–∞—á–∏–ù–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∑–¥–∞—Ç—å –æ–Ω–ª–∞–π–Ω-—á–∞—Ç–∞ –¥–ª—è —Å–∞–π—Ç–∞ —Å–æ —Å–ª–µ–¥—É—é—â–∏–º–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏:–û–±—â–µ–Ω–∏–µ —Å –ø–æ—Å–µ—Ç–∏—Ç–µ–ª—è–º–∏ –Ω–∞ –ª—é–±—ã—Ö —è–∑—ã–∫–∞—Ö–ó–∞–ø—Ä–æ—Å –≤–∞—Ä–∏–∞–Ω—Ç–∞ –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –∑–∞–ø—Ä–æ—Å –ø–æ—Å–µ—Ç–∏—Ç–µ–ª—è —É chatGPT, –æ–±—É—á–µ–Ω–Ω–æ–≥–æ –Ω–∞ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π –∫–æ–º–ø–∞–Ω–∏–∏–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤—Å–µ –Ω–∞ –±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–∞—Ö–ò—Ç–∞–∫, –ø–æ–µ—Ö–∞–ª–∏!–®–∞–≥ ‚Ññ1: –í—ã–±–æ—Ä —Å–µ—Ä–≤–∏—Å–∞ –¥–ª—è –æ–Ω–ª–∞–π–Ω-—á–∞—Ç–∞–î–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∑–∞–¥–∞—á–∏ –Ω–∞–º –Ω—É–∂–Ω–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å—Ç–∞–≤–∏—Ç—å —Å–≤–æ–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–∞ —Å–æ–±—ã—Ç–∏–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ—Å–µ—Ç–∏—Ç–µ–ª—è. –ü—Ä–∏ —ç—Ç–æ–º —Å–∞–º —Å–µ—Ä–≤–∏—Å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –±–µ—Å–ø–ª–∞—Ç–Ω—ã–º.–ü–æ –∏—Ç–æ–≥—É –±—ã–ª –≤—ã–±—Ä–∞–ª —Å–µ—Ä–≤–∏—Å Tawk.to, —É –∫–æ—Ç–æ—Ä–æ–≥–æ –µ—Å—Ç—å –≤–æ—Ç —ç—Ç–∏ –¥–≤–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞:–®–∞–≥ ‚Ññ2: –û–±—É—á–µ–Ω–∏–µ chatGPT–î–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π –∫–æ–º–ø–∞–Ω–∏–∏ –º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É:üóÇÔ∏è¬†LlamaIndex¬†ü¶ô¬†(GPT Index)https://github.com/jerryjliu/llama_index–í–æ—Ç –ø—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∏–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏!pip install llama-index
import os
os.environ["OPENAI_API_KEY"] = 'YOUR_OPENAI_API_KEY'
from llama_index import GPTSimpleVectorIndex, SimpleDirectoryReader
documents = SimpleDirectoryReader('data').load_data()
index = GPTSimpleVectorIndex(documents)
# save to disk
index.save_to_disk('index.json')
# load from disk
index = GPTSimpleVectorIndex.load_from_disk('index.json')
index.query("<question_text>?") –í –∫–∞—á–µ—Å—Ç–≤–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∞–∑—ã –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –∫—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏ –∏ –ø–æ–º–µ—Å—Ç–∏–º –µ–≥–æ –≤ —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª:  # auras.txt
AURA Services
AURA Services, based in Tel Aviv, Israel, is a platform that mediates between local partner performers and clients and focused on short-term local services.
AURA do marketing and local advertisement to promote local partner performers.
The company acts as a broker and charges a commission from local partner performers for promotion of each service for clients.–®–∞–≥ ‚Ññ3: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –±–∞–∑—ã –≤ Notion–í—Å–µ –ø–æ—Å—Ç—É–ø–∞—é—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π –º—ã –±—É–¥–µ–º —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –≤ Notion.–í–æ—Ç —à–∞–±–ª–æ–Ω —Ç–∞–±–ª–∏—Ü—ã:https://candied-cactus-f66.notion.site/9cc1b8d874244cc0bef06d6de762d8df –ü—Ä–æ—Ü–µ—Å—Å —Å–æ–∑–¥–∞–Ω–∏—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Ö–æ—Ä–æ—à–æ –æ–ø–∏—Å–∞–Ω –≤ —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ:  https://notionso.ru/kb/sozdanie-integratsiy-s-pomoschyu-api-notion/ –£ –Ω–∞—Å –±—É–¥–µ—Ç –≤–æ—Ç —Ç–∞–∫–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π –≤ —Ç–∞–±–ª–∏—Ü–µ Notion:  def insertDatabase(databaseId, record, token):
    headers = {
        "Accept": "application/json",
        "Authorization": "Bearer " + token,
        "Content-Type": "application/json",
        "Notion-Version": "2021-05-13",
    }
    createUrl = "https://api.notion.com/v1/pages"
    data = json.dumps(record)
    res = requests.request("POST", createUrl, headers=headers, data=data)
    return res –ü—Ä–∏–º–µ—Ä –∑–∞–ø–∏—Å–∏ –≤ —Ç–∞–±–ª–∏—Ü—É:  record = {"parent": { "database_id": notion_DB_id },"properties": {}}
record['properties']['URL'] = {"title": [{"text": {"content": "https://aura-s.com/"}}]}
record['properties']['Message'] = {"rich_text": [{"text": {"content": "Hello World!"}}]}
record['properties']['chatGPT_reply_English'] = {"rich_text": [{"text": {"content": "How i can help you?"}}]}
insertDatabase(databaseId, record, token)–®–∞–≥ ‚Ññ4: –°–æ–∑–¥–∞–Ω–∏–µ –¢–µ–ª–µ–≥—Ä–∞–º-–±–æ—Ç–∞–ù–∞–π–¥–∏—Ç–µ –±–æ—Ç–∞ @BotFather ¬†–∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –µ–º—É –∫–æ–º–∞–Ω–¥—É /start¬†–∏–ª–∏ /newbot, —á—Ç–æ–±—ã —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–≥–æ –±–æ—Ç–∞. –ó–∞—Ç–µ–º —Å–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º, –≤–≤–æ–¥—è –Ω–∞–∑–≤–∞–Ω–∏–µ –∏ –∫–æ—Ä–æ—Ç–∫–æ–µ –∏–º—è –¥–ª—è –≤–∞—à–µ–≥–æ –±–æ—Ç–∞. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –≤—ã –ø–æ–ª—É—á–∏—Ç–µ –æ—Ç–≤–µ—Ç —Å —Ç–æ–∫–µ–Ω–æ–º –±–æ—Ç–∞ –∏ —Å—Å—ã–ª–∫–æ–π –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é. –í–∞–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–∫–µ–Ω –≤ –Ω–∞–¥–µ–∂–Ω–æ–º –º–µ—Å—Ç–µ, —Ç–∞–∫ –∫–∞–∫ –æ–Ω –Ω–µ–æ–±—Ö–æ–¥–∏–º –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Å–≤—è–∑–∏ –º–µ–∂–¥—É –≤–∞–º–∏ –∏ –≤–∞—à–∏–º –±–æ—Ç–æ–º.–®–∞–≥ ‚Ññ5: –ó–∞–ø—É—Å–∫ HTTP API –Ω–∞ Flask–î–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–æ—Å—Ç—É–ø–∞—é—â–∏—Ö –æ—Ç –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π —Å–æ–æ–±—â–µ–Ω–∏–π –Ω–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞–ø–∏—Å–∞—Ç—å –Ω–µ–±–æ–ª—å—à–æ–π Backend –Ω–∞ Flask.–£ –Ω–∞—Å –±—É–¥–µ—Ç —Ç–æ–ª—å–∫–æ –æ–¥–Ω–∞ —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –≤ API, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –≤—Ö–æ–¥—è—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, –∑–∞—Ç–µ–º –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å –≤ chatGPT –∏ –ø—Ä–æ—Å–∏—Ç –µ–≥–æ –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ 3-—Ö —è–∑—ã–∫–∞—Ö. –ü–æ–ª—É—á–µ–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã –º—ã –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ —Ç–µ–ª–µ–≥—Ä–∞–º –±–æ—Ç –∏ –≤ —Ç–∞–±–ª–∏—Ü—É Notion.–í–æ—Ç –∫–æ–¥ –Ω–∞—à–µ–≥–æ API:from flask import Flask, render_template, redirect, url_for, request, session, jsonify
from flask_cors import CORS
from os import path
import json
import os
import requests
import datetime
import openai
import telebot
app = Flask(__name__)
CORS(app)  # —ç—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å API –∏–∑ React-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
bot = telebot.TeleBot(config.tg_bot_key)
    
# /api/v1.0/new_online_chat_message
@app.route('/api/v1.0/new_online_chat_message', methods=['GET'])
def new_online_chat_message():
    url = request.args.get("url", '-')
    message = request.args.get("message", '-')
    print('[START - new_online_chat_message]')
    notion_DB_id = 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'
    record = {"parent": { "database_id": notion_DB_id },"properties": {}}
    record['properties']['URL'] = {"title": [{"text": {"content": url}}]}
    record['properties']['Message'] = {"rich_text": [{"text": {"content": message}}]}
    
    # Ask chatGPT
    reply = ''
    if message != '-':
        index = GPTSimpleVectorIndex.load_from_disk('/wiki/index.json')
				
				# ID —á–∞—Ç–∞ —Å —Ç–µ–ª–µ–≥—Ä–∞–º –±–æ—Ç–æ–º        
				chat_id = 'XXXXXXXXX'
        # English
        response = index.query(message + '. Answer in English', response_mode="compact")
        record['properties']['chatGPT_reply_English'] = {"rich_text": [{"text": {"content": response.response}}]}
        reply = response.response
        bot.send_message(chat_id, 'üá¨üáß\n' + reply)
        
        # Spanish
        response = index.query(message + '. Answer in Spanish', response_mode="compact")
        record['properties']['chatGPT_reply_Spanish'] = {"rich_text": [{"text": {"content": response.response}}]}
        reply = response.response
        bot.send_message(chat_id, 'üá™üá∏\n' + reply)
        
        # German
        response = index.query(message + '. Answer in German', response_mode="compact")
        record['properties']['chatGPT_reply_German'] = {"rich_text": [{"text": {"content": response.response}}]}
        reply = response.response
        bot.send_message(chat_id, 'üá©üá™\n' + reply)
    
    res = notion_api.insertDatabase(notion_DB_id, record, config.notion_token)
    print(res, res.text)
    ###
    return reply
if __name__ == "__main__":
    app.run(debug=True, host='0.0.0.0', port=5000)–®–∞–≥ ‚Ññ6: –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –∏–∑ —á–∞—Ç–∞ –Ω–∞ —Å–∞–π—Ç–µ –Ω–∞ HTTP API–ò —Ñ–∏–Ω–∞–ª—å–Ω–∞—è —á–∞—Å—Ç—å - –º—ã –¥–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤ –≤–∏–¥–∂–µ—Ç —á–∞—Ç–∞ Tawk.to:<!--Start of Tawk.to Script-->
<script type="text/javascript">
var Tawk_API=Tawk_API||{}, Tawk_LoadStart=new Date();
(function(){
var s1=document.createElement("script"),s0=document.getElementsByTagName("script")[0];
s1.async=true;
s1.src='https://embed.tawk.to/640e244831ebfa0fe7f220c1/1grbjrffn';
s1.charset='UTF-8';
s1.setAttribute('crossorigin','*');
s0.parentNode.insertBefore(s1,s0);
})();
  window.Tawk_API = window.Tawk_API || {};
window.Tawk_API.onChatMessageVisitor = function(message){
  var x = new XMLHttpRequest();
x.open("GET", "https://–ê–î–†–ï–°_API/api/v1.0/new_online_chat_message?url=aura-s.com&message="+message, true);
x.onload = function (){
    alert( x.responseText);
}
x.send(null);
  
};
</script>
<!--End of Tawk.to Script-->–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã–ò—Ç–æ–≥–Ø –Ω–∞–¥–µ—é—Å—å –¥–∞–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –±—É–¥–µ—Ç –≤–∞–º –ø–æ–ª–µ–∑–Ω–æ –∏ –µ—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –µ–≥–æ –≥–¥–µ-—Ç–æ, –Ω–∞–ø–∏—à–∏—Ç–µ –ø–æ–∂–∞–ª—É–π—Å—Ç–∞ –ø—Ä–æ —ç—Ç–æ –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö.–ò –∫–æ–Ω–µ—á–Ω–æ —è –≥–æ—Ç–æ–≤ –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –≤—Å–µ –≤–∞—à–∏ –≤–æ–ø—Ä–æ—Å—ã, –ø–∏—à–∏—Ç–µ –≤ –º–æ–π –¢–ì.      Tags: chatgptgpt-3—á–∞—Ç—á–∞—Ç-–±–æ—Çtelegramnotionpythonflaskgpt-indextawk.to  Hubs: Website developmentPythonJavaScriptArtificial IntelligenceFlask          


