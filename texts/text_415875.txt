

Слово лингвисту: что если компьютеры заговорят лучше нас / Habr


              2  July  2018 at 15:20  Слово лингвисту: что если компьютеры заговорят лучше нас Semantics *Artificial Intelligence       
Фото: Александр Корольков/РГ


3 июня, в заключительный день Московского книжного фестиваля на Красной площади, лингвист Александр Пиперски выступал с рассказом о компьютерной лингвистике. Он говорил о машинных переводах, нейросетях, векторном отображении слов и поднимал вопросы границ искусственного интеллекта. 


Лекцию слушали разные люди. Справа от меня, например, клевала носом китайская туристка. Александр, наверняка, тоже понимал — пара лишних цифр, формул и слов об алгоритмах, и люди убегут в соседнюю палатку слушать фантастов.


Я попросил Александра подготовить для Хабра «режиссерскую версию» лекции, где не вырезано ничего, что может усыпить случайных туристов. Ведь больше всего выступлению не хватало аудитории с толковыми вопросами и вообще хорошей дискуссии. Думаю, здесь мы ее сможем развить. 


Где начинается ИИ

C недавних пор мы постоянно общаемся с компьютерами голосом, а всякие Алиса, Алекса и Сири голосом нам отвечают. Если посмотреть со стороны, кажется, что компьютер нас понимает, выдает списки релевантных сайтов, сообщает адрес ближайшего ресторана, указывает, как к нему пройти.


Похоже, мы имеем дело с довольно умным устройством. Можно даже сказать, это устройство обладает тем, что называется искусственный интеллект (ИИ). Хоть никто толком не понимает, что это значит и где проходят границы.


Когда нам говорят «ИИ выполняет творческие функции, которые считаются прерогативой человека» — что это значит? Что такое творческие функции? Какая функция творческая, а какая нет? Подбор ближайшего китайского ресторана — творческая функция? Сейчас кажется, что скорее нет. 


Мы постоянно склонны отказывать компьютеру в искусственном интеллекте. Как только мы привыкли к интеллектуальным проявлениям, которые делает компьютер, мы говорим, «это не ИИ, это полная ерунда, шаблонные задачи, ничего интересного».


Простой пример — с нашей точки зрения нет ничего тупее карманного калькулятора. Он продается в любом ларьке за 50 рублей. Возьмите обычный восьмиразрядный калькулятор, потыкайте на кнопочки и получите результат в считанные секунды. Ну подумаешь, считает какие-то вещи. Это же не интеллект. 


А представьте себе такую машинку в XVIII веке. Она казалась бы чудом, потому что вычисление было прерогативой человека. 


Так же происходит и с компьютерной лингвистикой. Мы склонны презирать все ее достижения. Я ввожу в Google запрос «стихи Пушкина», он находит страницу на которой написано «А.С. Пушкин — Стихотворения». Казалось бы, что такого? Совершенно нормальное поведение. Но компьютерным лингвистам пришлось потратить десятки лет, чтобы по слову стихи находилось слово стихотворение, чтобы по слову Пушкина находилось слово Пушкин и не находилось Пушки.

Компьютерные шахматы и машинные переводы

Компьютерная лингвистика зародилась одновременно с компьютерными шахматами — а ведь шахматы когда-то тоже были прерогативой человека. Клод Шеннон, один из основоположников информатики, в 1950 году написал статью, как запрограммировать компьютер, чтобы он играл в шахматы. По его словам, мы можем выработать два типа стратегий.


A — с полным перебором продолжений. Надо тестировать все возможные ходы на каждом этапе.

B — перебирать только те продолжения, которые оцениваются как перспективные.


Человек, очевидно, использует стратегию B. Гроссмейстер, скорее всего, перебирает только разумные на его взгляд варианты, и за довольно быстрое время выдает хороший ход.


Стратегия A сложна для реализации. По подсчету Шеннона, чтобы просчитать три хода, надо перебрать 109 вариантов, и если позиция оценивается в одну микросекунду (что было сверхоптимистично в середине XX века), то на один ход понадобится 17 минут. А три хода вперед — это ничтожная глубина предсказания. 


Вся дальнейшая история шахмат состоит в разработке приемов, которые позволят не перебирать все подряд, а понять — что надо перебирать, а что не надо. И победа над человеком уже достигнута, окончательно и бесповоротно. Компьютер обошел чемпиона мира по шахматам лет 20 назад, и с тех пор только совершенствуется.


Лучшей программа считалась Stockfish. В прошлом году с ней сыграла 100 партий программа AlphaZero. 


Белые
Черные
Победа белых
Ничья
Победа черных


AlphaZero
Stockfish
25
25
0


Stockfish
AlphaZero
0
47
3



AlphaZero — это искусственная нейронная сеть, которая просто четыре часа играла в шахматы сама с собой. И научилась играть лучше, чем все программы до нее.


Похожее происходит в компьютерной лингвистике сейчас — всплеск нейросетевого моделирования. Над машинными шахматами начали работать одновременно с машинными переводами — в середине прошлого века. С тех пор выделяют три этапа развития. 

— Машинный перевод на основе правил

Он устроен очень просто — примерно как на уроках грамматики, компьютер выделяет подлежащее, сказуемое, дополнение. Понимает, какими словами все это переводится на другой язык, узнает, как там выражать подлежащие, сказуемые, дополнения, и все.

Такой перевод развивался лет 30, не имея больших успехов.

— Статистический (фразовый) перевод 

Компьютер опирается на большую базу данных текстов, переведенных человеком. Подбирает в ней слова и словосочетания, которые соответствуют словам и словосочетаниям оригинала, собирает их в предложения на языке перевода и выдает результат.


Когда в интернете пишут про очередные “20 самых тупых машинных переводов” — скорее всего, речь именно про фразовый перевод. Хотя он и достиг некоторых успехов.

— Нейросетевой перевод

Про него будем говорить подробнее. Он вошел в массовое использование буквально на наших глазах: Гугл включил нейросетевой перевод в конце 2016 года. Для русского он появился в марте 2017. Яндекс запустил в конце 2017 года гибридную систему основанную на нейросетях и статистике.

Нейросети

Нейросетевой перевод основан на такой идее: если математически смоделировать и воспроизвести работу нейронов в голове человека, то можно предположить, что и компьютер научится работать с языком так же, как человек. 


Для этого взглянем на клетки в мозгу человека.


Вот естественный нейрон. От ядра отходит длинный отросток — аксон. Он крепится к отросткам из других клеток — синапсам. По аксонам в синапсы клетки клетки передают информацию о некоторых электрохимических процессах. Из каждой клетки выходит только один аксон, а синапсов может входить много. Сигналы распространяются, и так происходит передача информации. 


Некоторые клетки связаны с внешним миром. Они получают сигналы, которые дальше обрабатываются нейронной сетью.


А вот простейшая математическая модель того, что мы можем здесь сделать. Я нарисовал девять связанных кружочков. Это нейроны.




Шесть нейронов слева — входной слой, который получает сигнал от внешней среды. Нейроны второго и третьего слоя не соприкасаются с окружающей средой, а только с другими нейронами. Введем правило — если в нейрон входят по крайней мере две стрелочки от активированных нейронов, то этот нейрон тоже активируется.


Нейронная сеть обрабатывает сигнал, поступающий на вход, и в конечном итоге, правый — выходной — нейрон загорается или не загорается. При такой архитектуре, для активации правого нейрона нужно хотя бы четыре активированных нейрона в левом ряду. Если горят 6 или 5 — он точно загорится, если от 0 до 3 — точно не загорится. Но если горят четыре, то он загорится только если они распределены равномерно: 2 в верхней половине и 2 в нижней.




Получается, что простейшая схема из девяти кружочков приводит к довольно ветвистому рассуждению.


Искусственные нейронные сети работают примерно так же, но обычно не с такими простыми вещами, как “загорелось/не загорелось” (то есть 1 или 0), а с действительными числами.


Возьмём для примера сеть из 5 нейронов — два во входном слое, два в среднем (скрытом) и один в выходном. Между всеми нейронами соседних слоёв есть связи, к которым приписаны числа — веса. Чтобы узнать, что получается в пока незаполненном нейроне, сделаем очень простую вещь: посмотрим, какие связи в него ведут, домножим вес каждой связи на число, которое записано в нейроне предшествующего слоя, из которого идёт эта связь, и всё это просуммируем. В верхнем зелёном нейроне на схеме получается 50 